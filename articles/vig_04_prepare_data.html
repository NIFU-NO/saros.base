<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Prepare dataset • saros.base</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="vig_04_prepare_data_files/libs/quarto-html/popper.min.js"></script><script src="vig_04_prepare_data_files/libs/quarto-html/tippy.umd.min.js"></script><link href="vig_04_prepare_data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="vig_04_prepare_data_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare dataset">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">saros.base</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vig_01_basic_file_system.html">Basic R, Quarto and file system setup</a></li>
    <li><a class="dropdown-item" href="../articles/vig_02_project_setup.html">Project setup</a></li>
    <li><a class="dropdown-item" href="../articles/vig_03_configure_report_cycle.html">Configure Saros settings for a project</a></li>
    <li><a class="dropdown-item" href="../articles/vig_04_prepare_data.html">Prepare dataset</a></li>
    <li><a class="dropdown-item" href="../articles/vig_05_standard_variable_names.html">Standard variable naming in longitudinal projects</a></li>
    <li><a class="dropdown-item" href="../articles/vig_06_prepare_chapter_overview.html">Preparing the chapter overview</a></li>
    <li><a class="dropdown-item" href="../articles/vig_07_adjust_report_cycle_settings.html">Draft report</a></li>
    <li><a class="dropdown-item" href="../articles/vig_31_render.html">Render</a></li>
    <li><a class="dropdown-item" href="../articles/vig_32_render_problems.html">Error messages and Frequently Asked Questions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NIFU-NO/saros.base/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1></h1>




      <small class="dont-index">Source: <a href="https://github.com/NIFU-NO/saros.base/blob/main/vignettes/vig_04_prepare_data.qmd" class="external-link"><code>vignettes/vig_04_prepare_data.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <header id="title-block-header" class="quarto-title-block"><h1 class="title">Prepare dataset</h1></header><p>Although these are requirements for effective Saros use, there are also general good recommendations for documenting data. One should therefore implement the checkpoints from day 1, i.e. already when programming the questionnaire, documenting the instruments used, as well as obtaining register data used to draw samples.</p>
<section class="section level2"><h2 id="what-variables-do-saros-need">What variables do Saros need?<a class="anchor" aria-label="anchor" href="#what-variables-do-saros-need"></a>
</h2>
<p>The data set needs the variables stated in the <a href="vig_05_prepare_chapter_overview.qmd">chapter overview</a>, and possibly the mesos variable if mesos reports are created. Variables that are not used are ignored, but logged in a txt file (and in the R console) when you run <code><a href="../reference/draft_report.html">saros.base::draft_report()</a></code> so that you can check that things went as expected - maybe you entered the wrong variable name.</p>
</section><section class="section level2"><h2 id="sec-variable-name">Variable name<a class="anchor" aria-label="anchor" href="#sec-variable-name"></a>
</h2>
<p>The principles of variable names and variable labels aim to allow Saros to automatically handle similar variables together, and different variables separately. They may seem draconian but ensure that confusion is avoided and Saros offer benefits by cleaning the output for you.</p>
<ul>
<li><p>R handles variable names with spaces, Nordic letters, distinguishes between small and capital letters, odd characters, etc. and has no limit on the number of characters. BUT, many other programs have such restrictions.</p></li>
<li><p>Keep variable names to a maximum of 8-10 characters.</p></li>
<li><p>Use only English (ASCII) lowercase letters, numbers and underscores.</p></li>
<li><p>Variable names must start with a letter.</p></li>
<li>
<p>Try to avoid letters that look the same in upper and lower case.</p>
<ul>
<li>See [standard variable names in longitudinal projects](vig_05_standard_variable_names.qmd)</li>
</ul>
</li>
<li><p>Optimally, all batteries should share the same prefix in the variable name, which is unique from all other batteries/variables. For example, one can name the variables s_100-s_120 for one battery, g_121-g_129 for another battery, etc. and specify that <code>variable_name_separator = "_"</code>. However, another equally fine approach is to name variables in a self-explanatory</p></li>
</ul></section><section class="section level2"><h2 id="data-types">Data types<a class="anchor" aria-label="anchor" href="#data-types"></a>
</h2>
<p>Saros will eventually contain more control checks of variables, but for now check that the data type is the way you want Saros to handle them.</p>
<section class="level2"><h3 id="categorical-variables">Categorical variables<a class="anchor" aria-label="anchor" href="#categorical-variables"></a>
</h3>
<p>This type of data is particularly important in the social sciences, and needs extra attention in Saros and R.</p>
<ul>
<li>When you load data in the formats Stata, SPSS or SAS with <code>haven::read_*</code>, R does not know how to handle the potential possibilities for <em>various types of missing</em> (e.g. not managed, skipped, not reached, illegible writing, etc). In R there is only one type of missing (NA). Categorical variables from Stata/SPSS/SAS data are thus set with a temporary {labelled} data type. It can be tempting to leave them like this as it looks nice and clear when you print out the variables to the console:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://larmarange.github.io/labelled/" class="external-link">labelled</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nifu-no.github.io/saros.base/">saros.base</a></span><span class="op">)</span></span>
<span><span class="va">ex_survey</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>b_1 <span class="op">=</span> <span class="fu">labelled</span><span class="fu">::</span><span class="fu"><a href="https://larmarange.github.io/labelled/reference/to_labelled.html" class="external-link">to_labelled</a></span><span class="op">(</span><span class="va">b_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">b_1</span><span class="op">)</span> <span class="co"># If your categorical variables look like this, you need to convert them</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  b_1                n
  &lt;dbl+lbl&gt;      &lt;int&gt;
1 1 [Not at all]   129
2 2 [A bit]        143
3 3 [A lot]         28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This is how they ought to look</span></span>
<span><span class="va">ex_survey</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">b_1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  b_1            n
  &lt;fct&gt;      &lt;int&gt;
1 Not at all   129
2 A bit        143
3 A lot         28</code></pre>
</div>
</div>
<p><strong>But the <code>labelled</code> variable type is not intended to be used more than at the start. It will certainly cause trouble in general in R, and also in Saros.</strong> For example, the apparently fine overview you see above will not be possible to display in tables or in a Quarto document like this.</p>
<p>Instead, use the factor type in R. One converts all categorical variables in an SPSS/Stata/SAS from the <code>labelled' type to the</code>factor’ type as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optionally convert all unordered to ordered factors if they are mostly that</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">ex_survey</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.factor</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">.x</span>, ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<ul>
<li><p>Distinguishing between nominal (unordered factor) and ordinal (ordered factor) variables is particularly useful in Saros, as they can have separate color scales or output types, and that some sorting algorithms do not break up ordinal scales.</p></li>
<li><p>Never create dummy variables for Saros. If in the future Saros should need it for regression, etc, it will be created automatically.</p></li>
<li><p>Check that the order of all categorical variables is correct. Can be done with the following code. Check the values ​​column.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_survey</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://larmarange.github.io/labelled/reference/look_for.html" class="external-link">look_for</a></span><span class="op">(</span><span class="st">"^[abdep]_"</span>, details<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> pos variable label                     col_type missing unique_values
 4   a_1      Do you consent to the fo~ fct      25      3

 5   a_2      Do you consent to the fo~ fct      36      3

 6   a_3      Do you consent to the fo~ fct      28      3

 7   a_4      Do you consent to the fo~ fct      25      3

 8   a_5      Do you consent to the fo~ fct      30      3

 9   a_6      Do you consent to the fo~ fct      26      3

 10  a_7      Do you consent to the fo~ fct      30      3

 11  a_8      Do you consent to the fo~ fct      31      3

 12  a_9      Do you consent to the fo~ fct      31      3

 13  b_1      How much do you like liv~ fct      0       3


 14  b_2      How much do you like liv~ fct      0       3


 15  b_3      How much do you like liv~ fct      0       3


 18  d_1      Rate your degree of conf~ fct      0       11










 19  d_2      Rate your degree of conf~ fct      0       11










 20  d_3      Rate your degree of conf~ fct      0       11










 21  d_4      Rate your degree of conf~ fct      0       11










 22  e_1      How often do you do the ~ fct      0       5




 23  e_2      How often do you do the ~ fct      0       5




 24  e_3      How often do you do the ~ fct      0       5




 25  e_4      How often do you do the ~ fct      0       5




 26  p_1      To what extent do you ag~ fct      0       4



 27  p_2      To what extent do you ag~ fct      0       4



 28  p_3      To what extent do you ag~ fct      0       4



 29  p_4      To what extent do you ag~ fct      34      5



 values                    na_values na_range
 No
 Yes
 No
 Yes
 No
 Yes
 No
 Yes
 No
 Yes
 No
 Yes
 No
 Yes
 No
 Yes
 No
 Yes
 Not at all
 A bit
 A lot
 Not at all
 A bit
 A lot
 Not at all
 A bit
 A lot
 0\nCannot do at all
 1
 2
 3
 4
 5\nModerately can do
 6
 7
 8
 9
 10\nHighly certain can do
 0\nCannot do at all
 1
 2
 3
 4
 5\nModerately can do
 6
 7
 8
 9
 10\nHighly certain can do
 0\nCannot do at all
 1
 2
 3
 4
 5\nModerately can do
 6
 7
 8
 9
 10\nHighly certain can do
 0\nCannot do at all
 1
 2
 3
 4
 5\nModerately can do
 6
 7
 8
 9
 10\nHighly certain can do
 Very rarely
 Rarely
 Sometimes
 Often
 Very often
 Very rarely
 Rarely
 Sometimes
 Often
 Very often
 Very rarely
 Rarely
 Sometimes
 Often
 Very often
 Very rarely
 Rarely
 Sometimes
 Often
 Very often
 Strongly disagree
 Somewhat disagree
 Somewhat agree
 Strongly agree
 Strongly disagree
 Somewhat disagree
 Somewhat agree
 Strongly agree
 Strongly disagree
 Somewhat disagree
 Somewhat agree
 Strongly agree
 Strongly disagree
 Somewhat disagree
 Somewhat agree
 Strongly agree                              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Alternatively</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="va">ex_survey</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.factor</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x1_sex
[1] "Males"   "Females"

$x2_human
[1] "Robot?"              "Definitely humanoid"

$x3_nationality
[1] "Andorra"  "Belize"   "Cameroon" "Denmark"  "Eswatini" "Fiji"     "Ghana"

$a_1
[1] "No"  "Yes"

$a_2
[1] "No"  "Yes"

$a_3
[1] "No"  "Yes"

$a_4
[1] "No"  "Yes"

$a_5
[1] "No"  "Yes"

$a_6
[1] "No"  "Yes"

$a_7
[1] "No"  "Yes"

$a_8
[1] "No"  "Yes"

$a_9
[1] "No"  "Yes"

$b_1
[1] "Not at all" "A bit"      "A lot"

$b_2
[1] "Not at all" "A bit"      "A lot"

$b_3
[1] "Not at all" "A bit"      "A lot"

$d_1
 [1] "0\nCannot do at all"       "1"
 [3] "2"                         "3"
 [5] "4"                         "5\nModerately can do"
 [7] "6"                         "7"
 [9] "8"                         "9"
[11] "10\nHighly certain can do"

$d_2
 [1] "0\nCannot do at all"       "1"
 [3] "2"                         "3"
 [5] "4"                         "5\nModerately can do"
 [7] "6"                         "7"
 [9] "8"                         "9"
[11] "10\nHighly certain can do"

$d_3
 [1] "0\nCannot do at all"       "1"
 [3] "2"                         "3"
 [5] "4"                         "5\nModerately can do"
 [7] "6"                         "7"
 [9] "8"                         "9"
[11] "10\nHighly certain can do"

$d_4
 [1] "0\nCannot do at all"       "1"
 [3] "2"                         "3"
 [5] "4"                         "5\nModerately can do"
 [7] "6"                         "7"
 [9] "8"                         "9"
[11] "10\nHighly certain can do"

$e_1
[1] "Very rarely" "Rarely"      "Sometimes"   "Often"       "Very often"

$e_2
[1] "Very rarely" "Rarely"      "Sometimes"   "Often"       "Very often"

$e_3
[1] "Very rarely" "Rarely"      "Sometimes"   "Often"       "Very often"

$e_4
[1] "Very rarely" "Rarely"      "Sometimes"   "Often"       "Very often"

$p_1
[1] "Strongly disagree" "Somewhat disagree" "Somewhat agree"
[4] "Strongly agree"

$p_2
[1] "Strongly disagree" "Somewhat disagree" "Somewhat agree"
[4] "Strongly agree"

$p_3
[1] "Strongly disagree" "Somewhat disagree" "Somewhat agree"
[4] "Strongly agree"

$p_4
[1] "Strongly disagree" "Somewhat disagree" "Somewhat agree"
[4] "Strongly agree"   </code></pre>
</div>
</div>
<ul>
<li>All categorical variables should be of the factor type with all possible response options as its categorical levels (levels). This makes the graphs and tables as correct as possible. See example below to correct this if you receive the data as e.g. <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> or <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> (something you should definitely avoid at all costs as it is time-consuming to restore the data.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>   <span class="va">ex_survey</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"p_"</span><span class="op">)</span>,</span>
<span>      <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">.x</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"Strongly disagree"</span>,</span>
<span>            <span class="st">"Somewhat disagree"</span>,</span>
<span>            <span class="st">"Somewhat agree"</span>,</span>
<span>            <span class="st">"Strongly agree"</span><span class="op">)</span>,</span>
<span>         ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># FALSE if nominal</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">p_3</span><span class="op">)</span></span></code></pre></div>
</div>
<p>## Text variables (character, string, open text fields)</p>
<ul>
<li><p>Used for open text fields, names, etc. where there are normally more than 20 variants.</p></li>
<li><p>You are responsible for de-identification/anonymization! Neither Saros nor its developers take responsibility for this. Saros will only display variables that you have explicitly requested to be made available - the rest will always be dropped. But to avoid incorrect use, it may be ok to remove the most personally identifying information - to be on the safe side.</p></li>
<li><p>Use <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code> to convert e.g. categorical data (factor/ordered) to text. Use the <a href="https://stringr.tidyverse.org" class="external-link">stringr</a> package to work with such data.</p></li>
<li><p>NOT FULLY IMPLEMENTED YET: Saros will issue a warning if a text variable contains fewer than 10 unique values, if all of these have string lengths of fewer than 40 characters, and there are multiple duplicates of one of the values. It will also give a warning if it is possible to convert the text variable to numbers without missing everything. The criteria for these warnings can be adjusted/turned off.</p></li>
</ul>
<section class="level3"><h4 id="mesos-variable">Mesos variable<a class="anchor" aria-label="anchor" href="#mesos-variable"></a>
</h4>
<ul>
<li>In order to create mesos reports (institution-specific reports), a variable that identifies the mesos groups (i.e., school name, institution name) must be prepared and cleaned. Due to file path length and username generation, these should have short names and preferably without spaces (University of Manchester =&gt; UoM, Ethon boarding school =&gt; Ethon). Use underscores instead of spaces or special characters. Best of all, stick to ASCII. The names should also be consistent across reports as the institution will get usernames for each unique spelling. “UoM_and_LSE” in one report and “UoM” in another report will result in two different sets of usernames/passwords.</li>
</ul></section></section><section class="level2"><h3 id="number-variables">Number variables<a class="anchor" aria-label="anchor" href="#number-variables"></a>
</h3>
<ul>
<li>R allows two types of number variables: integers and real numbers (numeric/double). Saros currently does not differentiate between these two types.</li>
</ul></section></section><section class="section level2"><h2 id="variable-labels-sec-variable-labels">Variable labels {#sec-variable labels}<a class="anchor" aria-label="anchor" href="#variable-labels-sec-variable-labels"></a>
</h2>
<p>Variable labels are typically the actual question formulation in a questionnaire, or a definition of how data has been collected.</p>
<ul>
<li><p>All variables to be used must have a label, this also applies to e.g. independent variables that you have created yourself. See the <a href="https://cran.r-project.org/web/packages/labelled/index.html" class="external-link"><code>{labelled}</code></a> package for functions to easily set labels if something is missing.</p></li>
<li><p>Note that in R, variable labels are not considered to be still valid if you have changed the variable’s content (with e.g. <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>), and <strong>the labels therefore unfortunately disappear</strong>. However, you can copy them back in afterwards with <code>labelled::copy_labels_from(original_data)</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="va">original_data</span> <span class="op">&lt;-</span> <span class="va">ex_survey</span></span>
<span><span class="va">modified_data</span> <span class="op">&lt;-</span></span>
<span>   <span class="va">original_data</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x1_sex <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">x1_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://larmarange.github.io/labelled/reference/copy_labels.html" class="external-link">copy_labels_from</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">original_data</span><span class="op">)</span></span></code></pre></div>
</div>
<ul>
<li><p>All labels for the variables used must be unique (prefix+suffix in total). <code><a href="../reference/draft_report.html">saros.base::draft_report()</a></code> will issue a warning if it detects multiple variables that share exactly identical labels. If e.g. a dependent categorical variable (<code>factor</code> or <code>ordered</code>) and a dependent text variable (open text field, <code>character</code>) have identical labels (which you cannot/do not want to change), you must ask saros to group the output on <code>"variable_type_dep"</code> as well.</p></li>
<li><p>Labels for variables that are related (batteries) must have a common prefix (prefix and suffix are typically separated by <code>" - "</code>). Matrix questions in Qualtrics, SurveyXact, etc. will almost always sort this out for you. But does one of the questions have an extra space the variables will be treated as if they come from different batteries.</p></li>
<li><p>The labels should not have double separators (” - “) unless intended. Can create a mess.</p></li>
<li><p>But more importantly than with variable names, <strong>different batteries must not share the same label prefix</strong>. Do you have a lot of batteries with “To what extent do you agree/disagree with the following statements?” then you will have a problem. It can be solved by being more specific in the claim (“… the following claims about your work situation?”), or by separating the batteries also by <a href="#sec-variable-name" class="quarto-xref">Section 2</a> or data type.</p></li>
</ul></section><section class="section level2"><h2 id="storage-of-data">Storage of data<a class="anchor" aria-label="anchor" href="#storage-of-data"></a>
</h2>
<p>R handles all kinds of data formats, though some are clearly better</p>
<div class="line-block">Format | Labels | Storage space | Speed ​​| Read/write in Stata? | Read/write in SPSS? | Open Standard | Unicode? |</div>
<p>|————-|————————|———- —-|————|———————|——— ————|————–|————| | sav (SPSS) | Limitation on length | | | Yes | Yes | No | | | dta (Stata) | Limitation on length | | | Yes | Yes | No | | | Parquet | Good | Very small | Very fast | No | No | Yes | | | qs | Everything is possible | Very small | Very fast | No | No | | | | Excel | No | Bad | Bad | Yes | Yes | No | | | CSV | No | Worst | Worst | Yes | Yes | Yes | Confusing | | | | | | | | | | | | | | | | | | |</p>
<p>: Advantages and disadvantages of different data formats</p>
</section><section class="section level2"><h2 id="complex-survey-designs">Complex survey designs<a class="anchor" aria-label="anchor" href="#complex-survey-designs"></a>
</h2>
<p>Is sample weighting, stratification, clustering or similar used? Contact Stephan in good time. Saros is supposed to work on this as well, but has not been tested yet.</p>
</section><section class="section level2"><h2 id="project-specific-data-preparations">Project-specific data preparations<a class="anchor" aria-label="anchor" href="#project-specific-data-preparations"></a>
</h2>
<p>Sorry, we don’t have much help here.</p>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephan Daus, Nordic Institute for The Studies of Innovation, Research and Education (NIFU), Kristiania University College.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
